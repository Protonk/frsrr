% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bin.R
\name{frsr_bin}
\alias{frsr_bin}
\title{FRSR Bin}
\usage{
frsr_bin(
  x_min = 0.25,
  x_max = 1,
  n_bins = 4,
  NRmax = 0,
  objective = c("max_relative_error", "avg_relative_error", "rmse_relative_error"),
  dependent = c("avg_relative_error", "max_relative_error", "rmse_relative_error"),
  float_samples = 1024,
  magic_samples = 2048,
  magic_min = 1596980000L,
  magic_max = 1598050000L,
  weighted = FALSE
)
}
\arguments{
\item{x_min}{Numeric lower bound (> 0). Default is 0.25.}

\item{x_max}{Numeric upper bound (> x_min). Default is 1.0.}

\item{n_bins}{Integer. The number of bins to divide the range into. Default is 4.}

\item{NRmax}{Integer. The maximum number of Newton-Raphson iterations (default: 0).}

\item{objective}{Character scalar naming the metric to optimize. Defaults to
\code{"max_relative_error"}.}

\item{dependent}{Character scalar naming the metric reported as dependent on
the chosen objective. Defaults to \code{"avg_relative_error"}.
Both `objective` and `dependent` accept: \code{"max_relative_error"},
\code{"avg_relative_error"}, or \code{"rmse_relative_error"}.}

\item{float_samples}{Integer. The number of floating-point samples generated per bin.}

\item{magic_samples}{Integer. The number of magic constant samples to generate per bin.}

\item{magic_min}{Integer. The minimum magic constant to test (default: 1596980000).}

\item{magic_max}{Integer. The maximum magic constant to test (default: 1598050000).}

\item{weighted}{Logical; if \code{TRUE}, weight the float sampler by the
number of representable significands in each exponent stratum. Default is
\code{FALSE}.}
}
\value{
A data frame with columns:
    \item{N_bins}{Total number of bins}
    \item{Location}{Bin number (1-indexed)}
    \item{Range_Min}{Minimum value of the bin range}
    \item{Range_Max}{Maximum value of the bin range}
    \item{Magic}{Optimal magic constant as an integer}
    \item{Objective}{Metric minimized for that bin (e.g., maximum relative error)}
    \item{Dependent}{Secondary metric reported for the winning magic.}
}
\description{
Generate optimal magic constants for the Fast Reciprocal Square Root algorithm over specified bins
by minimizing the maximum relative error.
}
\details{
This function divides the range [x_min, x_max] into n_bins bins and generates float_samples
floating-point samples within each bin. It then tests magic_samples magic constants within
the range [magic_min, magic_max] to find the optimal magic constant for each bin that minimizes
the maximum relative error per bin. The achievable error and optimal constants will change with
bin size and number of bins, as well as the integer and float samples. 

The FRSR is periodic over 0.25 to 1.0 with a magic constant of 0x5f3759df. I don't know if 
this is generally true. Interestingly, the linear approximation to the logarithm used is
periodic over integral powers of two, and so loops twice before the FISR does once.
}
\examples{
\donttest{
# Generate optimal magic constants for the range [0.25, 1.0] divided into 4 bins
result <- frsr_bin()
print(result)
#   N_bins Location Range_Min Range_Max      Magic   Objective   Dependent
# 1      4        1 0.2500000 0.3535534 1597413411 0.0004549199 0.000134129
# 2      4        2 0.3535534 0.5000000 1597115686 0.0000617551 0.000033011
# 3      4        3 0.5000000 0.7071068 1597150657 0.0000348620 0.000021047
# 4      4        4 0.7071068 1.0000000 1597488127 0.0008389181 0.000244221
# }
}
